<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>THE SMART COMPASS</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA;
            color: #212529;
            line-height: 1.6;
        }
        .text-gradient-hero {
            background-image: linear-gradient(to right, #00A693, #00C9A7);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .animate-fade-in {
            animation: fadeIn 1s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .animate-slide-up {
            animation: slideUp 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) both;
        }
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background-color: #e2e8f0;
            border: 1px solid #e2e8f0;
        }
        .calendar-day {
            background-color: white;
            padding: 8px;
            text-align: center;
        }
        .calendar-day-label {
            font-weight: 600;
            background-color: #f7fafc;
        }
        /* Chat Widget Styles */
        #chat-container {
            position: fixed;
            bottom: 5rem;
            right: 1.5rem;
            width: 90%;
            max-width: 400px;
            height: 70vh;
            max-height: 500px;
            background-color: white;
            border-radius: 1rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            z-index: 1000;
            transition: all 0.3s ease-in-out;
            transform: scale(0.8);
            opacity: 0;
            visibility: hidden;
        }
        #chat-container.chat-open {
            transform: scale(1);
            opacity: 1;
            visibility: visible;
        }
        #chat-messages {
            flex-grow: 1;
            overflow-y: auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
        }
        .message {
            max-width: 75%;
            padding: 0.75rem 1rem;
            border-radius: 1rem;
            word-wrap: break-word;
            margin-bottom: 0.5rem;
        }
        .message.from-me {
            background-color: #3b82f6;
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 0;
        }
        .message.from-other {
            background-color: #e5e7eb;
            color: #1f2937;
            align-self: flex-start;
            border-bottom-left-radius: 0;
        }
        #chat-bubble {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            z-index: 1000;
        }
        /* Full-page hero section */
        #home {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding-top: 0;
            padding-bottom: 0;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="#home" class="flex items-center space-x-2">
                <!-- SVG Kompas sebagai logo -->
                <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-green-500" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 3.14a1 1 0 011.9 0l1.196 2.45c.163.335.51.547.886.547h2.766a1 1 0 01.554 1.831L14.73 9.42a1 1 0 01-.364.918l-2.007 1.666a1 1 0 00-.472 1.13l.635 2.54a1 1 0 01-1.42 1.054l-2.073-.918a1 1 0 00-1.13.472l-1.666 2.007a1 1 0 01-1.832-.554V14.73a1 1 0 01-.547-.886l-2.45-1.196a1 1 0 010-1.9l2.45-1.196a1 1 0 01.886-.547h2.766a1 1 0 00.918-.364l1.666-2.007a1 1 0 011.054-1.42l2.54.635a1 1 0 001.13-.472l2.007-1.666a1 1 0 01.918-.918z" clip-rule="evenodd" />
                </svg>
                <span class="text-xl font-bold text-gray-800">THE SMART COMPASS</span>
            </a>
            <nav class="hidden md:flex items-center space-x-6">
                <a href="#about-stunting" class="text-gray-600 hover:text-green-500 transition-colors">Apa itu Stunting?</a>
                <a href="#prevention" class="text-gray-600 hover:text-green-500 transition-colors">Pencegahan</a>
                <a href="#data-input" class="text-gray-600 hover:text-green-500 transition-colors">Isi Data</a>
                <a href="#features" class="text-gray-600 hover:text-green-500 transition-colors">Fitur</a>
                <a href="#stunting-data" class="text-gray-600 hover:text-green-500 transition-colors">Data Stunting</a>
                <a href="buatjanji.html" class="text-gray-600 hover:text-green-500 transition-colors">Buat Janji Temu</a>
                <a href="#news-section" class="text-gray-600 hover:text-green-500 transition-colors">Berita</a>
            </nav>
            <button class="md:hidden text-gray-600 text-2xl">
                <i class="fas fa-bars"></i>
            </button>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">

        <!-- Hero Section -->
        <section id="home" class="py-20 text-center animate-fade-in bg-gradient-to-r from-teal-50 to-blue-50">
            <h2 class="text-5xl font-extrabold text-gray-900 leading-tight">
                <span class="text-gradient-hero">Bersama Cegah Stunting</span>
            </h2>
            <p class="mt-4 text-lg text-gray-700 max-w-2xl mx-auto">
                Untuk Indonesia yang Lebih Sehat
                <br>
                Portal informasi lengkap tentang stunting di Indonesia. Pelajari penyebab, dampak, dan cara pencegahan stunting untuk masa depan anak yang lebih baik.
            </p>
            <div class="mt-8 flex justify-center space-x-4">
                <a href="#about-stunting" class="bg-gradient-to-r from-teal-400 to-green-500 text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:from-teal-500 hover:to-green-600 transition-transform transform hover:scale-105">Pelajari Lebih Lanjut</a>
            </div>
        </section>

        <!-- About Stunting Section -->
        <section id="about-stunting" class="py-16">
            <div class="bg-white p-8 rounded-2xl shadow-lg animate-slide-up">
                <h3 class="text-3xl font-bold text-center text-gray-800 mb-4">Apa Itu Stunting?</h3>
                <div class="text-center text-gray-600 mb-6 max-w-2xl mx-auto">
                    <p class="mb-4">Stunting adalah kondisi gagal tumbuh pada anak balita akibat kekurangan gizi kronis, terutama dalam 1.000 Hari Pertama Kehidupan (HPK). Kondisi ini menyebabkan anak menjadi terlalu pendek untuk usianya.</p>
                    <p>Stunting tidak hanya berdampak pada pertumbuhan fisik, tetapi juga dapat menghambat perkembangan otak dan kognitif anak, serta meningkatkan risiko penyakit di masa depan. Penting bagi orang tua untuk memantau pertumbuhan anak secara rutin untuk mencegah dan mengatasi kondisi ini sejak dini.</p>
                </div>
            </div>
        </section>

        <!-- Stunting Prevention Section -->
        <section id="prevention" class="py-16 text-center">
            <h3 class="text-3xl font-bold text-gray-800 mb-8">Pencegahan Stunting</h3>
            <p class="text-lg text-gray-600 mb-12 max-w-2xl mx-auto">Langkah-langkah efektif untuk mencegah stunting sejak dini</p>
            <div class="grid md:grid-cols-3 gap-8">
                <!-- Card 1: Masa Kehamilan -->
                <div class="bg-white p-6 rounded-2xl shadow-lg animate-slide-up border-t-4 border-red-500">
                    <div class="text-red-500 text-5xl mb-4">
                        <i class="fas fa-female"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800">Masa Kehamilan</h4>
                    <ul class="text-left text-gray-600 mt-4 space-y-2">
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Konsumsi tablet tambah darah (TTD)</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Protein hewani minimal 1 porsi/hari</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Pemeriksaan kehamilan rutin</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Istirahat yang cukup</li>
                    </ul>
                </div>
                <!-- Card 2: 0-6 Bulan -->
                <div class="bg-white p-6 rounded-2xl shadow-lg animate-slide-up border-t-4 border-orange-500" style="animation-delay: 0.1s;">
                    <div class="text-orange-500 text-5xl mb-4">
                        <i class="fas fa-baby"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800">0-6 Bulan</h4>
                    <ul class="text-left text-gray-600 mt-4 space-y-2">
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>ASI Eksklusif selama 6 bulan</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Inisiasi Menyusu Dini (IMD)</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Pemantauan tumbuh kembang</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Imunisasi lengkap</li>
                    </ul>
                </div>
                <!-- Card 3: 6-24 Bulan -->
                <div class="bg-white p-6 rounded-2xl shadow-lg animate-slide-up border-t-4 border-green-500" style="animation-delay: 0.2s;">
                    <div class="text-green-500 text-5xl mb-4">
                        <i class="fas fa-child"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800">6-24 Bulan</h4>
                    <ul class="text-left text-gray-600 mt-4 space-y-2">
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>MPASI bergizi seimbang</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Lanjutkan pemberian ASI</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Protein hewani setiap hari</li>
                        <li><i class="fas fa-check-circle text-green-500 mr-2"></i>Stimulasi tumbuh kembang</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Gizi Seimbang Section -->
        <section id="gizi-seimbang" class="py-16 text-center">
            <h3 class="text-3xl font-bold text-gray-800 mb-8">Panduan Gizi Seimbang</h3>
            <p class="text-lg text-gray-600 mb-12 max-w-2xl mx-auto">Pola makan sehat untuk mendukung tumbuh kembang optimal</p>
            <div class="grid md:grid-cols-4 gap-8">
                <!-- Card 1: Protein Hewani -->
                <div class="bg-white p-6 rounded-2xl shadow-lg animate-slide-up border-t-4 border-red-500">
                    <div class="text-red-500 text-5xl mb-4">
                        <i class="fas fa-fish"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800">Protein Hewani</h4>
                    <p class="text-gray-600">Ikan, ayam, telur, daging, susu</p>
                    <div class="bg-green-100 text-green-800 text-sm font-semibold mt-4 py-1 px-3 rounded-full inline-block">
                        1-2 porsi/hari
                    </div>
                </div>
                <!-- Card 2: Karbohidrat -->
                <div class="bg-white p-6 rounded-2xl shadow-lg animate-slide-up border-t-4 border-orange-500" style="animation-delay: 0.1s;">
                    <div class="text-orange-500 text-5xl mb-4">
                        <i class="fas fa-bread-slice"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800">Karbohidrat</h4>
                    <p class="text-gray-600">Nasi, roti, kentang, ubi</p>
                    <div class="bg-green-100 text-green-800 text-sm font-semibold mt-4 py-1 px-3 rounded-full inline-block">
                        3-4 porsi/hari
                    </div>
                </div>
                <!-- Card 3: Sayuran -->
                <div class="bg-white p-6 rounded-2xl shadow-lg animate-slide-up border-t-4 border-green-500" style="animation-delay: 0.2s;">
                    <div class="text-green-500 text-5xl mb-4">
                        <i class="fas fa-leaf"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800">Sayuran</h4>
                    <p class="text-gray-600">Bayam, wortel, brokoli, tomat</p>
                    <div class="bg-green-100 text-green-800 text-sm font-semibold mt-4 py-1 px-3 rounded-full inline-block">
                        2-3 porsi/hari
                    </div>
                </div>
                <!-- Card 4: Buah-buahan -->
                <div class="bg-white p-6 rounded-2xl shadow-lg animate-slide-up border-t-4 border-blue-500" style="animation-delay: 0.3s;">
                    <div class="text-blue-500 text-5xl mb-4">
                        <i class="fas fa-apple-alt"></i>
                    </div>
                    <h4 class="text-xl font-bold text-gray-800">Buah-buahan</h4>
                    <p class="text-gray-600">Pisang, jeruk, apel, pepaya</p>
                    <div class="bg-green-100 text-green-800 text-sm font-semibold mt-4 py-1 px-3 rounded-full inline-block">
                        2-3 porsi/hari
                    </div>
                </div>
            </div>
        </section>

        <!-- Action Buttons Section -->
        <section id="data-input" class="py-16 text-center animate-slide-up">
            <div class="bg-white p-8 rounded-2xl shadow-lg border-b-4 border-teal-500">
                <h3 class="text-3xl font-bold text-gray-800 mb-4">Mulai Perjalanan Sehat Anak Anda Sekarang!</h3>
                <p class="text-gray-600 mb-6 max-w-2xl mx-auto">
                    Isi data diri dan kesehatan anak Anda untuk mendapatkan pemantauan pertumbuhan yang lebih personal.
                </p>
                <div class="grid md:grid-cols-2 gap-6 mt-8">
                    <!-- Card 1: Isi Data Pasien -->
                    <a href="isidata.html" class="block w-full max-w-sm mx-auto">
                        <div class="bg-gray-50 p-6 rounded-2xl shadow-inner border border-gray-200 hover:bg-gray-100 transition-colors">
                            <h4 class="text-xl font-semibold mb-2">Isi Data Pasien</h4>
                            <p class="text-gray-600 mb-4">Lengkapi informasi pribadi dan biodata pasien.</p>
                            <span class="inline-block bg-teal-500 text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:bg-teal-600 transition-colors transform hover:scale-105">
                                Isi Sekarang
                            </span>
                        </div>
                    </a>

                    <!-- Card 2: Isi Data Kembang Anak -->
                    <a href="datakembanganak.html" class="block w-full max-w-sm mx-auto">
                        <div class="bg-gray-50 p-6 rounded-2xl shadow-inner border border-gray-200 hover:bg-gray-100 transition-colors">
                            <h4 class="text-xl font-semibold mb-2">Isi Data Kembang Anak</h4>
                            <p class="text-gray-600 mb-4">Masukkan data pertumbuhan anak untuk deteksi dini stunting.</p>
                            <span class="inline-block bg-teal-500 text-white font-semibold py-3 px-8 rounded-full shadow-lg hover:bg-teal-600 transition-colors transform hover:scale-105">
                                Isi Sekarang
                            </span>
                        </div>
                    </a>
                </div>
            </div>
        </section>

        <!-- Features Section -->
        <section id="features" class="py-16">
            <h3 class="text-3xl font-bold text-center mb-10">Fitur Unggulan Kami</h3>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                
                <!-- Fitur 1: Deteksi Dini -->
                <div class="bg-white p-6 rounded-2xl shadow-lg transition-transform transform hover:scale-105 animate-slide-up border-t-4 border-teal-500">
                    <div class="text-teal-500 text-4xl mb-4 text-center"><i class="fas fa-chart-line"></i></div>
                    <h4 class="text-xl font-bold text-gray-800 text-center">Deteksi Dini Stunting</h4>
                    <p class="mt-2 text-gray-600 text-center">Identifikasi risiko stunting secara cepat dan akurat dengan algoritma cerdas kami.</p>
                </div>

                <!-- Fitur 2: Pemantauan Personal -->
                <div class="bg-white p-6 rounded-2xl shadow-lg transition-transform transform hover:scale-105 animate-slide-up" style="animation-delay: 0.1s;">
                    <div class="text-teal-500 text-4xl mb-4 text-center"><i class="fas fa-baby"></i></div>
                    <h4 class="text-xl font-bold text-gray-800 text-center">Pemantauan Personal</h4>
                    <p class="mt-2 text-gray-600 text-center">Pantau pertumbuhan dan perkembangan anak Anda sesuai standar Kementerian Kesehatan.</p>
                </div>

                <!-- Fitur 3: Konsultasi Ahli -->
                <div class="bg-white p-6 rounded-2xl shadow-lg transition-transform transform hover:scale-105 animate-slide-up" style="animation-delay: 0.2s;">
                    <div class="text-teal-500 text-4xl mb-4 text-center"><i class="fas fa-comments"></i></div>
                    <h4 class="text-xl font-bold text-gray-800 text-center">Konsultasi dengan Ahli</h4>
                    <p class="mt-2 text-gray-600 text-center">Dapatkan saran dan rekomendasi dari ahli gizi dan dokter langsung melalui sistem.</p>
                </div>
            </div>
        </section>

        <!-- Stunting Data Section -->
        <section id="stunting-data" class="py-16">
            <h3 class="text-3xl font-bold text-center mb-10">Trend Prevalensi Stunting di Indonesia</h3>
            <div class="bg-white p-6 rounded-2xl shadow-lg">
                <canvas id="stuntingChart"></canvas>
            </div>
        </section>

        <!-- Calendar Section -->
        <section id="calendar-section" class="py-16">
            <h3 class="text-3xl font-bold text-center mb-10">Jadwal Janji Temu</h3>
            <div class="bg-white p-6 rounded-2xl shadow-lg">
                <!-- Calendar View -->
                <div class="flex justify-between items-center mb-4">
                    <button class="text-teal-500 hover:text-teal-600"><i class="fas fa-chevron-left"></i></button>
                    <span class="text-lg font-semibold">September 2025</span>
                    <button class="text-teal-500 hover:text-teal-600"><i class="fas fa-chevron-right"></i></button>
                </div>
                <div class="calendar-grid">
                    <div class="calendar-day-label">Min</div>
                    <div class="calendar-day-label">Sen</div>
                    <div class="calendar-day-label">Sel</div>
                    <div class="calendar-day-label">Rab</div>
                    <div class="calendar-day-label">Kam</div>
                    <div class="calendar-day-label">Jum</div>
                    <div class="calendar-day-label">Sab</div>
                    <!-- Calendar days (Example) -->
                    <div class="calendar-day text-gray-400">31</div>
                    <div class="calendar-day">1</div>
                    <div class="calendar-day">2</div>
                    <div class="calendar-day">3</div>
                    <div class="calendar-day">4</div>
                    <div class="calendar-day">5</div>
                    <div class="calendar-day">6</div>
                    <div class="calendar-day">7</div>
                    <div class="calendar-day bg-teal-100 text-teal-800 font-bold border border-teal-500 rounded-md">
                        8<br><span class="text-xs font-normal">Janji Temu</span>
                    </div>
                    <div class="calendar-day">9</div>
                    <div class="calendar-day">10</div>
                    <div class="calendar-day">11</div>
                    <div class="calendar-day">12</div>
                    <div class="calendar-day">13</div>
                    <div class="calendar-day">14</div>
                    <div class="calendar-day">15</div>
                    <div class="calendar-day">16</div>
                    <div class="calendar-day">17</div>
                    <div class="calendar-day">18</div>
                    <div class="calendar-day">19</div>
                    <div class="calendar-day">20</div>
                    <div class="calendar-day">21</div>
                    <div class="calendar-day">22</div>
                    <div class="calendar-day">23</div>
                    <div class="calendar-day">24</div>
                    <div class="calendar-day">25</div>
                    <div class="calendar-day">26</div>
                    <div class="calendar-day">27</div>
                    <div class="calendar-day">28</div>
                    <div class="calendar-day">29</div>
                    <div class="calendar-day">30</div>
                </div>

                <!-- Appointment List -->
                <div class="mt-8">
                    <h4 class="text-xl font-bold mb-4">Daftar Janji Temu</h4>
                    <div class="bg-gray-100 p-4 rounded-xl shadow-inner mb-4">
                        <p class="font-semibold">Senin, 8 September 2025</p>
                        <p>Janji Temu: Dr. Firas Rusendi</p>
                        <p>Waktu: 10:00 AM</p>
                        <p>Lokasi: Puskesmas Tumbuh Sehat</p>
                    </div>
                    <a href="buatjanji.html" class="w-full inline-block text-center bg-teal-500 text-white py-2 rounded-full font-semibold hover:bg-teal-600 transition-colors">
                        Tambah Janji Temu Baru
                    </a>
                </div>
            </div>
        </section>

        <!-- News Section -->
        <section id="news-section" class="py-16">
            <h3 class="text-3xl font-bold text-center mb-10">Berita Kesehatan Terkini</h3>
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- News Card 1 -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden transition-transform transform hover:scale-105 animate-slide-up">
                    <img src="5ce6681c-d1bc-45c6-bde0-af5fd724f27f.jpg" alt="Gambar Berita 1" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <h4 class="text-xl font-bold text-gray-800">Waspada Demam Berdarah di Musim Hujan</h4>
                        <p class="text-sm text-gray-500 mt-1">20 September 2025</p>
                        <p class="mt-3 text-gray-600">Kementerian Kesehatan mengimbau masyarakat untuk meningkatkan kewaspadaan terhadap kasus demam berdarah di musim penghujan. Edukasi tentang 3M Plus sangat penting.</p>
                        <a href="#" class="mt-4 inline-block text-teal-500 hover:text-teal-600 font-semibold">Baca Selengkapnya <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>

                <!-- News Card 2 -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden transition-transform transform hover:scale-105 animate-slide-up" style="animation-delay: 0.1s;">
                    <img src="makanan-bergizi-seimbang.jpg" alt="Gambar Berita 2" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <h4 class="text-xl font-bold text-gray-800">Pentingnya Gizi Seimbang untuk Cegah Stunting</h4>
                        <p class="text-sm text-gray-500 mt-1">15 September 2025</p>
                        <p class="mt-3 text-gray-600">Ahli gizi menekankan pentingnya asupan nutrisi yang lengkap pada 1000 Hari Pertama Kehidupan anak untuk mencegah stunting secara permanen.</p>
                        <a href="#" class="mt-4 inline-block text-teal-500 hover:text-teal-600 font-semibold">Baca Selengkapnya <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>

                <!-- News Card 3 -->
                <div class="bg-white rounded-2xl shadow-lg overflow-hidden transition-transform transform hover:scale-105 animate-slide-up" style="animation-delay: 0.2s;">
                    <img src="6a552641-imunisasi-lanjutan.jpg" alt="Gambar Berita 3" class="w-full h-48 object-cover">
                    <div class="p-6">
                        <h4 class="text-xl font-bold text-gray-800">Pemerintah Luncurkan Program Imunisasi Massal</h4>
                        <p class="text-sm text-gray-500 mt-1">10 September 2025</p>
                        <p class="mt-3 text-gray-600">Program imunisasi serentak di seluruh provinsi diluncurkan untuk meningkatkan cakupan vaksinasi dan mencegah penyakit menular pada anak.</p>
                        <a href="#" class="mt-4 inline-block text-teal-500 hover:text-teal-600 font-semibold">Baca Selengkapnya <i class="fas fa-arrow-right"></i></a>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Floating Chat Button -->
    <button id="chat-widget" class="fixed bottom-6 right-6 z-50 p-4 bg-teal-500 text-white rounded-full shadow-lg transition-transform transform hover:scale-110 focus:outline-none">
        <i class="fas fa-comments text-2xl"></i>
    </button>
    
    <!-- Chat Container -->
    <div id="chat-container">
        <!-- Chat Header -->
        <div class="bg-teal-500 text-white p-4 rounded-t-2xl flex justify-between items-center">
            <h3 class="text-lg font-semibold">Layanan Pelanggan 24 Jam</h3>
            <button id="close-chat" class="text-white hover:text-gray-200 focus:outline-none">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <!-- Chat messages container -->
        <div id="chat-messages" class="flex-1 p-4 space-y-2 overflow-y-auto flex flex-col">
            <div id="user-id-display" class="text-center text-sm text-gray-500 mb-2"></div>
            <div class="text-center text-gray-400 text-sm">Anda terhubung ke ruang obrolan.</div>
        </div>
        
        <!-- Chat input form -->
        <form id="chat-form" class="p-4 bg-gray-50 border-t border-gray-200 flex items-center">
            <input type="text" id="chat-input" placeholder="Ketik pesan Anda..." class="flex-1 p-3 rounded-full border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-colors">
            <button type="submit" class="bg-teal-500 text-white p-3 rounded-full ml-2 hover:bg-teal-600 transition-colors">
                <i class="fas fa-paper-plane"></i>
            </button>
        </form>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-6 mt-12">
        <div class="container mx-auto text-center text-sm">
            <p>&copy; 2025 THE SMART COMPASS. Semua Hak Cipta Dilindungi.</p>
            <p class="mt-2">Dibuat dengan <i class="fas fa-heart text-red-500"></i> untuk masa depan yang lebih baik.</p>
        </div>
    </footer>

    <script type="module">
        // Firebase SDKs
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, signInWithCustomToken, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, serverTimestamp, query, onSnapshot, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // Firebase Config and Initialization
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        let auth, db;
        let userId = null;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const initFirebase = async () => {
            if (Object.keys(firebaseConfig).length === 0) {
                console.error("Firebase config is missing. Please provide the firebase configuration.");
                return;
            }
            const app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);

            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    userId = user.uid;
                    document.getElementById('user-id-display').textContent = `ID Pengguna Anda: ${userId}`;
                    initChatRoom();
                } else {
                    const customToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
                    try {
                        if (customToken) {
                            await signInWithCustomToken(auth, customToken);
                        } else {
                            await signInAnonymously(auth);
                        }
                    } catch (error) {
                        console.error("Error signing in:", error);
                    }
                }
            });
        };

        const initChatRoom = () => {
            const chatForm = document.getElementById('chat-form');
            const chatInput = document.getElementById('chat-input');
            const chatMessages = document.getElementById('chat-messages');

            chatForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const userMessage = chatInput.value.trim();
                if (userMessage === '') return;
                
                // Display user message in the chat
                displayMessage(userMessage, true);
                chatInput.value = '';

                // Add loading indicator
                const loadingMessageId = 'loading-' + Date.now();
                displayMessage('...', false, loadingMessageId);

                try {
                    // Send message to Firebase
                    await addDoc(collection(db, `/artifacts/${appId}/public/data/chat`), {
                        userId: userId,
                        message: userMessage,
                        timestamp: serverTimestamp()
                    });

                    // Get response from chatbot
                    const botResponse = await runChatbot(userMessage);
                    
                    // Remove loading indicator
                    document.getElementById(loadingMessageId).remove();

                    // Display chatbot response
                    displayMessage(botResponse, false);
                } catch (error) {
                    console.error("Error with chatbot or writing to DB: ", error);
                    // Remove loading and show error message
                    document.getElementById(loadingMessageId).remove();
                    displayMessage("Maaf, terjadi kesalahan. Silakan coba lagi.", false);
                }
            });

            const q = query(collection(db, `/artifacts/${appId}/public/data/chat`), orderBy("timestamp"));
            onSnapshot(q, (snapshot) => {
                // Clear chat messages to rebuild from snapshot
                chatMessages.innerHTML = '';
                snapshot.forEach((doc) => {
                    const data = doc.data();
                    const isMyMessage = data.userId === userId;
                    displayMessage(data.message, isMyMessage);
                });
                chatMessages.scrollTop = chatMessages.scrollHeight; // Auto-scroll to the bottom
            }, (error) => {
                console.error("Error listening to messages:", error);
            });
        };
        
        function displayMessage(message, isFromMe, id = null) {
            const chatMessages = document.getElementById('chat-messages');
            const messageElement = document.createElement('div');
            messageElement.classList.add('message');
            if (id) {
                messageElement.id = id;
            }

            if (isFromMe) {
                messageElement.classList.add('from-me');
                messageElement.innerHTML = `<span class="font-bold">Anda:</span><br>${message}`;
            } else {
                messageElement.classList.add('from-other');
                messageElement.innerHTML = `<span class="font-bold">Bot:</span><br>${message}`;
            }
            chatMessages.appendChild(messageElement);
        }

        async function runChatbot(userQuery) {
            const systemPrompt = "Anda adalah asisten chatbot yang ramah dan berpengetahuan luas tentang stunting dan nutrisi anak. Berikan jawaban yang informatif, ringkas, dan mudah dimengerti.";
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
                tools: [{ "google_search": {} }],
            };

            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                throw new Error(`API error: ${response.statusText}`);
            }

            const result = await response.json();
            const candidate = result.candidates?.[0];

            if (candidate && candidate.content?.parts?.[0]?.text) {
                return candidate.content.parts[0].text;
            } else {
                return "Maaf, saya tidak dapat memproses permintaan ini.";
            }
        }

        initFirebase();
    </script>
    <script>
        const ctx = document.getElementById('stuntingChart').getContext('2d');
        const stuntingChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: ['2013', '2018', '2019', '2021', '2022', '2023', '2024'],
                datasets: [{
                    label: 'Prevalensi Stunting (%)',
                    data: [37.2, 30.8, 27.7, 24.4, 21.6, 21.5, 19.8],
                    backgroundColor: 'rgba(59, 130, 246, 0.8)',
                    borderColor: 'rgb(59, 130, 246)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                scales: {
                    y: {
                        beginAtZero: false,
                        title: {
                            display: true,
                            text: 'Prevalensi (%)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Tahun'
                        }
                    }
                },
                plugins: {
                    legend: {
                        display: true,
                        position: 'top',
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed.y !== null) {
                                    label += context.parsed.y + '%';
                                }
                                return label;
                            }
                        }
                    }
                }
            }
        });

        // Chat Widget Logic
        const chatWidget = document.getElementById('chat-widget');
        const chatContainer = document.getElementById('chat-container');
        const closeChatButton = document.getElementById('close-chat');
        let isChatOpen = false;
        
        const toggleChat = () => {
            isChatOpen = !isChatOpen;
            if (isChatOpen) {
                chatContainer.classList.add('chat-open');
            } else {
                chatContainer.classList.remove('chat-open');
            }
        };

        chatWidget.addEventListener('click', toggleChat);
        closeChatButton.addEventListener('click', toggleChat);

        // Intersection Observer for animations
        const observerOptions = {
            root: null,
            rootMargin: '0px',
            threshold: 0.1
        };

        const observer = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('is-visible');
                    observer.unobserve(entry.target);
                }
            });
        }, observerOptions);

        document.querySelectorAll('.animated-card').forEach(card => {
            observer.observe(card);
        });
    </script>
</body>
</html>
